Importer adresser med bredbåndstype til LOIS

ogr2ogr -overwrite -f MSSQLSpatial MSSQL:"server=lois.sql.kerteminde.local;driver=SQL Server Native Client 11.0;database=LOIS;trusted_connection=yes" -nln bredbaand1_xls -lco schema=k440 "[filimport]" -progress -skipfailures -nlt none

Denne forespørgsel opsummerer befolkningen i aldersgrupper:

SELECT
sum(CASE when pers.alder between 0 and 120 then 1 else 0 end) as total,
SUM(CASE WHEN pers.Alder between 0 and 6 then 1 else 0 end) as antal_0_6,
SUM(CASE WHEN pers.Alder between 7 and 17 then 1 else 0 end) as antal_7_17,
SUM(CASE WHEN pers.Alder between 18 and 24 then 1 else 0 end) as antal_18_24,
SUM(CASE WHEN pers.Alder between 25 and 39 then 1 else 0 end) as antal_25_39,
SUM(CASE WHEN pers.Alder between 40 and 64 then 1 else 0 end) as antal_40_64,
SUM(CASE WHEN pers.Alder >= 65 then 1 else 0 end) as antal_over_65
FROM dbo.CPR_AktivKom_GeoView pers  

Og denne forespørgsel opsummerer befolkning i aldersgrupper baseret på bredbåndstyperne: 

SELECT
--ROW_NUMBER() OVER (order by pers.standardadresse) AS fid,
--pers.Standardadresse,
--pers.POSTNR,
--pers.Postdistrikt,
x.listetype,
sum(CASE when pers.alder between 0 and 120 then 1 else 0 end) as total,
SUM(CASE WHEN pers.Alder between 0 and 6 then 1 else 0 end) as antal_0_6,
SUM(CASE WHEN pers.Alder between 7 and 17 then 1 else 0 end) as antal_7_17,
SUM(CASE WHEN pers.Alder between 18 and 24 then 1 else 0 end) as antal_18_24,
SUM(CASE WHEN pers.Alder between 25 and 39 then 1 else 0 end) as antal_25_39,
SUM(CASE WHEN pers.Alder between 40 and 64 then 1 else 0 end) as antal_40_64,
SUM(CASE WHEN pers.Alder >= 65 then 1 else 0 end) as antal_over_65
FROM dbo.CPR_AktivKom_GeoView pers  
right join k440.bredbaand1_xls x on pers.AdgAdr_id=x.adgadr_id
GROUP BY x.listetype
